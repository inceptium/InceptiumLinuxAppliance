(this.webpackJsonpinceptium=this.webpackJsonpinceptium||[]).push([[6],{1289:function(e,t,a){"use strict";var n=a(32),i=a(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(1)),s=(0,n(a(70)).default)(r.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"}),"Cloud");t.default=s},1290:function(e,t,a){"use strict";var n=a(32),i=a(44);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(1)),s=(0,n(a(70)).default)(r.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4c-1.48 0-2.85.43-4.01 1.17l1.46 1.46C10.21 6.23 11.08 6 12 6c3.04 0 5.5 2.46 5.5 5.5v.5H19c1.66 0 3 1.34 3 3 0 1.13-.64 2.11-1.56 2.62l1.45 1.45C23.16 18.16 24 16.68 24 15c0-2.64-2.05-4.78-4.65-4.96zM3 5.27l2.75 2.74C2.56 8.15 0 10.77 0 14c0 3.31 2.69 6 6 6h11.73l2 2L21 20.73 4.27 4 3 5.27zM7.73 10l8 8H6c-2.21 0-4-1.79-4-4s1.79-4 4-4h1.73z"}),"CloudOff");t.default=s},1367:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(387),s=a(14),c=a(22),o=a(10),l=a(63),u=a(1101),d=a(207),m=a(1289),p=a.n(m),j=a(1290),b=a.n(j),f=a(316),h=a(19),x=a(333),O=a(332),g=a(519),v=a(239),w=a(55),y=a(29),C=a(3),S=Object(l.a)((function(e){return{root:{display:"flex"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",height:240}}}));function P(e){var t=S(),a=Object(w.a)(),i=a.getUsers,r=a.deleteUser,l=Object(h.c)((function(e){return e.notification.isLoading})),m=Object(n.useState)(),j=Object(o.a)(m,2),P=j[0],N=j[1],B=Object(n.useState)(!1),k=Object(o.a)(B,2),T=k[0],W=k[1],E=Object(h.b)(),U=Object(n.useState)({id:"",username:""}),z=Object(o.a)(U,2),L=z[0],M=z[1],A=function(){i().then((function(e){return N(e)}))};Object(n.useEffect)(A,[]);var G=function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(t).then((function(){E(y.a.show({message:"Utente cancellato.",type:"info"})),A()})).catch((function(e){return E(y.a.show({message:"Impossibile cancellare l'utente ".concat(t," ").concat(e.message),type:"error"}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsxs)("div",{className:t.root,children:[Object(C.jsx)(x.a,{title:"Gestione utenti"}),Object(C.jsx)(O.a,{}),Object(C.jsxs)("main",{className:t.content,children:[Object(C.jsx)("div",{className:t.appBarSpacer}),Object(C.jsx)(u.a,{maxWidth:"lg",className:t.container,children:Object(C.jsx)(d.a,{container:!0,spacing:3,children:Object(C.jsxs)(d.a,{item:!0,xs:12,children:[Object(C.jsx)(g.a,{isLoading:l,title:"Lista utenti",columns:[{title:"Utente",field:"username"},{title:"Nome e cognome",field:"fullName"},{title:"E-mail",field:"email"},{title:"Tipologia",field:"type"},{title:"Descrizione",field:"description"},{title:"Stato",field:"isOnline",render:function(e){return Object(C.jsx)("div",{children:e.isOnline?Object(C.jsx)(f.a,{title:"Connesso",children:Object(C.jsx)(p.a,{})}):Object(C.jsx)(f.a,{title:"Disconnesso",children:Object(C.jsx)(b.a,{})})})}}],data:P,actions:[{icon:"add",tooltip:"Aggiungi utente",isFreeAction:!0,onClick:function(){return e.history.push("/user/add")}},{icon:"edit",tooltip:"Modifica",onClick:function(t,a){var n=a.username;return e.history.push("/user/".concat(n,"/edit"))}},function(t){if("admin"!==t.username)return{icon:"list",tooltip:"Gestione permessi",onClick:function(t,a){var n=a.username;return e.history.push("/user/".concat(n,"/manage-permissions"))}}},function(e){if("admin"!==e.username)return{icon:"delete",tooltip:"Elimina",onClick:function(e,t){var a=t.id,n=t.username;W(!0),M({id:a,username:n})}}}]}),Object(C.jsx)(v.a,{isOpen:T,handlePrimaryClose:function(){return W(!1)},handleSecondaryClose:function(){W(!1),G(L.id)},handleClose:function(){return W(!1)},title:"Attenzione",description:"Sei sicuro di voler eliminare l'utente ".concat(L.username,"?")})]})})})]})]})}var N=a(6),B=a(11),k=a(266),T=a(1094),W=a(1095),E=a(56),U=a(203),z=a(430),L=a(398),M=a(399),A=a(66),G=a(58),I=a(403),_=a(517),D=["confirmPassword"],q=Object(l.a)((function(e){return{root:{display:"flex"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",height:240},form:{marginTop:e.spacing(1),padding:e.spacing(2)},formControl:{marginTop:e.spacing(2),marginBottom:e.spacing(1)},submitContainer:{display:"flex",justifyContent:"flex-end"}}}));function F(e){var t=e.match.params.username,a=Object(h.b)(),r=q(),l=Object(G.g)(),m=Object(w.a)(),p=m.addUser,j=m.getUser,b=m.updateUser,f=m.isLoading,g=i.a.useRef(null),v=i.a.useState(0),S=Object(o.a)(v,2),P=S[0],F=S[1];i.a.useEffect((function(){g.current&&F(g.current.offsetWidth)}),[f]);var R=Object(n.useState)({username:"",name:"",surname:"",password:"",confirmPassword:"",email:"",type:"",description:""}),H=Object(o.a)(R,2),J=H[0],V=H[1];Object(n.useEffect)((function(){t&&j(t).then((function(e){V(Object(B.a)(Object(B.a)({},e),{},{confirmPassword:e.password}))}))}),[t]);var K=function(){var e=Object(c.a)(Object(s.a)().mark((function e(n,i){var r,c,o,u;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.setErrors,c=i.setSubmitting,n.confirmPassword,o=Object(N.a)(n,D),e.prev=2,!t){e.next=13;break}if(u={username:t},Object.keys(J).forEach((function(e){o[e]!==J[e]&&(u[e]=o[e])})),delete u.confirmPassword,!u){e.next=11;break}return e.next=10,b(u);case 10:a(y.a.show({message:"Utente aggiornato.",type:"success"}));case 11:e.next=16;break;case 13:return e.next=15,p(o);case 15:a(y.a.show({message:"Utente aggiunto.",type:"success"}));case 16:l.push("/user/list"),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(2),r(e.t0.error||e.t0.message),a(y.a.show({message:e.t0.message,type:"error"})),c(!1);case 24:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t,a){return e.apply(this,arguments)}}();return Object(C.jsxs)("div",{className:r.root,children:[Object(C.jsx)(x.a,{title:"Gestione utenti"}),Object(C.jsx)(O.a,{}),Object(C.jsxs)("main",{className:r.content,children:[Object(C.jsx)("div",{className:r.appBarSpacer}),Object(C.jsx)(u.a,{maxWidth:"lg",className:r.container,children:Object(C.jsx)(T.a,{children:Object(C.jsxs)(W.a,{className:r.cardcontent,children:[Object(C.jsxs)(A.a,{variant:"h6",gutterBottom:!0,children:[t?"Modifica":"Aggiungi"," ","utente"]}),Object(C.jsx)(E.b,{enableReinitialize:!0,initialValues:J,onSubmit:K,validationSchema:U.a().shape({username:U.c().required("Il nome utente \xe8 obbligatorio"),email:U.c().email("Inserire un indirizzo email valido"),password:U.c().required("Il campo password non pu\xf2 essere vuoto"),type:U.c().required("Specificare la tipologia di account"),confirmPassword:U.c().oneOf([U.b("password"),null],"Le password non coincidono").required("Il campo password non pu\xf2 essere vuoto")}),children:function(e){var t=e.values,a=e.touched,n=e.errors,i=e.isSubmitting,s=e.handleChange,c=e.handleBlur,o=e.handleSubmit;return Object(C.jsx)("form",{className:r.form,onSubmit:o,children:Object(C.jsxs)(d.a,{container:!0,spacing:3,children:[Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsx)(k.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"username",label:"Nome utente",onChange:s,onBlur:c,inputProps:{form:{autocomplete:"off"}},value:t.username,helperText:n.username&&a.username&&n.username,error:n.username&&a.username,disabled:i||f})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsxs)(L.a,{variant:"outlined",className:r.formControl,fullWidth:!0,children:[Object(C.jsx)(M.a,{ref:g,htmlFor:"outlined-age-native-simple",children:"Tipologia account"}),Object(C.jsxs)(z.a,{native:!0,value:t.type,onChange:s,labelWidth:P,inputProps:{id:"type"},error:n.type&&a.type,disabled:i||f||"admin"===t.username,children:[Object(C.jsx)("option",{value:""}),Object(C.jsx)("option",{value:"admins",children:"Amministratore"}),Object(C.jsx)("option",{value:"users",children:"Utente"})]}),Object(C.jsx)(I.a,{error:!0,children:n.type&&a.type&&n.type})]})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsx)(k.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"name",label:"Nome",onChange:s,onBlur:c,value:t.name,helperText:n.name&&a.name&&n.name,error:n.name&&a.name,disabled:i||f})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsx)(k.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"surname",label:"Cognome",onChange:s,onBlur:c,value:t.surname,helperText:n.surname&&a.surname&&n.surname,error:n.surname&&a.surname,disabled:i||f})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsx)(k.a,{variant:"outlined",margin:"normal",fullWidth:!0,label:"Password",type:"password",id:"password",onChange:s,onBlur:c,value:t.password,helperText:n.password&&a.password&&n.password,error:n.password&&a.password,disabled:i||f})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsx)(k.a,{variant:"outlined",margin:"normal",fullWidth:!0,label:"Conferma Password",type:"password",id:"confirmPassword",onChange:s,onBlur:c,value:t.confirmPassword,helperText:n.confirmPassword&&a.confirmPassword&&n.confirmPassword,error:n.confirmPassword&&a.confirmPassword,disabled:i||f})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsx)(k.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"Email",onChange:s,onBlur:c,inputProps:{form:{autocomplete:"off"}},value:t.email,helperText:n.email&&a.email&&n.email,error:n.email&&a.email,disabled:i||f})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:6,children:Object(C.jsx)(k.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"description",label:"Description",onChange:s,onBlur:c,value:t.description,helperText:n.description&&a.description&&n.description,error:n.description&&a.description,disabled:i||f})}),Object(C.jsx)(d.a,{item:!0,xs:12,sm:12,children:Object(C.jsx)("div",{className:r.submitContainer,children:Object(C.jsx)(_.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:i||f,isLoading:i,children:"Salva"})})})]})})}})]})})})]})]})}var R=a(62),H=a(272),J=a.p+"static/media/app_icon.82a94199.png",V=Object(l.a)((function(e){return{root:{display:"flex"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},row:{display:"flex"},appIcon:{height:e.spacing(5),marginTop:"7px",marginBottom:"7px",marginLeft:e.spacing(1),marginRight:e.spacing(2)}}}));function K(e){var t=e.match,a=e.history,i=V(),r=t.params.username,s=Object(n.useState)([]),c=Object(o.a)(s,2),l=c[0],m=c[1],p=Object(w.a)(),j=p.getApps,b=p.isLoading;return Object(n.useEffect)((function(){j().then((function(e){var t,a=Object(R.a)(e);try{for(a.s();!(t=a.n()).done;)t.value.permit=Math.random()>=.5}catch(n){a.e(n)}finally{a.f()}m(e)})).catch(console.error)}),[]),Object(C.jsxs)("div",{className:i.root,children:[Object(C.jsx)(x.a,{title:"Gestione permessi"}),Object(C.jsx)(O.a,{}),Object(C.jsxs)("main",{className:i.content,children:[Object(C.jsx)("div",{className:i.appBarSpacer}),Object(C.jsx)(u.a,{maxWidth:"lg",className:i.container,children:Object(C.jsx)(d.a,{container:!0,spacing:3,children:Object(C.jsx)(d.a,{item:!0,xs:12,children:Object(C.jsx)(g.a,{title:"Permessi utente: ".concat(r),isLoading:b,actions:[{icon:"save",tooltip:"Salva modifiche",isFreeAction:!0,onClick:function(){return a.push("/user/list")}}],columns:[{title:"Applicazione",field:"app_name",render:function(e){return Object(C.jsxs)("div",{className:i.row,children:[Object(C.jsx)("img",{src:J,className:i.appIcon,alt:""}),Object(C.jsx)("p",{children:e.app_name})]})}},{title:"Consenti",field:"permit",render:function(e){return Object(C.jsx)(H.a,{checked:e.permit,onChange:function(){},value:"primary",inputProps:{"aria-label":"primary checkbox"}})}}],data:l,options:{search:!1}})})})})]})]})}t.default=function(){return i.a.useEffect((function(){return function(){return console.log("Users UnMounting")}}),[]),Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(r.a,{exact:!0,path:"/user/list",component:P}),Object(C.jsx)(r.a,{exact:!0,path:"/user/add",component:F}),Object(C.jsx)(r.a,{exact:!0,path:"/user/:username/edit",component:F}),Object(C.jsx)(r.a,{exact:!0,path:"/user/:username/manage-permissions",component:K})]})}}}]);